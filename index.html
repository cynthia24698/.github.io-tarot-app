<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏°‡∏ô‡∏ï‡∏£‡∏≤‡πÅ‡∏°‡πà‡∏°‡∏î‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á - ‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏û‡πà‡∏ó‡∏≤‡πÇ‡∏£‡∏ï‡πå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #2a0944 50%, #3b185f 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }
        .header-font {
            font-family: 'Cinzel', serif;
        }
        .tarot-card {
            perspective: 1000px;
            cursor: pointer;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .tarot-card.flipped {
            transform: rotateY(180deg);
        }
        .tarot-card.reversed .card-front-content {
            transform: rotate(180deg);
        }
        .card-face {
            backface-visibility: hidden;
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.2);
            border: 2px solid rgba(216, 180, 254, 0.3);
        }
        .card-back {
            background: #1e1b4b;
            background-image: radial-gradient(circle at center, #4c1d95 0%, #1e1b4b 100%);
            position: relative;
            overflow: hidden;
        }
        .card-back::after {
            content: 'üîÆ';
            font-size: 3rem;
            opacity: 0.6;
        }
        .card-back::before {
            content: '';
            position: absolute;
            width: 80%;
            height: 80%;
            border: 1px solid rgba(216, 180, 254, 0.2);
            border-radius: 50%;
            animation: rotate 10s linear infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .card-front {
            background: #f8f0ff;
            color: #2e1065;
            transform: rotateY(180deg);
            padding: 20px;
            text-align: center;
            border: 3px solid #7c3aed;
        }
        .card-front-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
        }
        .lucky-number-ball {
            background: linear-gradient(135deg, #7c3aed, #c084fc);
            width: 55px;
            height: 55px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.6rem;
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.6);
            margin: 8px;
            border: 2px solid #ddd6fe;
        }
        .witchy-glow {
            filter: drop-shadow(0 0 10px #a855f7);
        }
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #7c3aed;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .credit-badge {
            background: rgba(124, 58, 237, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            backdrop-filter: blur(4px);
            padding: 4px 12px;
            border-radius: 99px;
            font-size: 0.75rem;
            color: #ddd6fe;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-top: 1rem;
            letter-spacing: 0.05em;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-5xl mx-auto text-center">
        <header class="mb-12">
            <h1 class="text-5xl md:text-6xl font-bold mb-3 text-purple-300 header-font tracking-tighter witchy-glow">‡∏°‡∏ô‡∏ï‡∏£‡∏≤‡πÅ‡∏´‡πà‡∏á‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤</h1>
            <p class="text-purple-200 opacity-80 italic tracking-widest text-sm">"‡πÄ‡∏û‡πà‡∏á‡∏à‡∏¥‡∏ï‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡∏™‡∏π‡πà‡∏Ñ‡∏≥‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏•‡∏±‡∏ö"</p>
            <!-- CREDIT ADDED HERE -->
            <div class="credit-badge header-font">
                <span>‚ú¶</span> Cynthia Tarot <span>‚ú¶</span>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-16 justify-items-center">
            <template id="card-template">
                <div class="flex flex-col items-center">
                    <span class="mb-4 text-purple-400 font-bold uppercase tracking-[0.2em] text-xs slot-label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</span>
                    <div class="tarot-card w-56 h-80 floating">
                        <div class="card-face card-back"></div>
                        <div class="card-face card-front">
                            <div class="card-front-content">
                                <span class="orientation-badge text-[0.6rem] font-bold tracking-widest uppercase mb-1"></span>
                                <div class="text-5xl mb-4 filter drop-shadow-md card-icon"></div>
                                <h3 class="font-bold text-lg mb-2 text-purple-900 card-title"></h3>
                                <p class="text-xs leading-relaxed text-purple-800 italic card-desc"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </template>
            <div id="cards-container" class="contents"></div>
        </div>

        <div class="flex flex-col items-center gap-6">
            <button id="reset-btn" onclick="resetGame()" class="bg-purple-900 hover:bg-purple-800 text-purple-100 font-bold py-4 px-14 rounded-full transition-all duration-500 shadow-[0_0_25px_rgba(168,85,247,0.4)] border border-purple-500/50 hover:scale-110 tracking-widest">
                ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏¥‡∏ò‡∏µ‡πÉ‡∏´‡∏°‡πà (‡∏™‡∏±‡∏ö‡πÑ‡∏û‡πà)
            </button>
        </div>

        <div id="summary" class="mt-20 p-6 md:p-10 bg-black/60 rounded-[3rem] border-2 border-purple-500/40 backdrop-blur-xl hidden max-w-3xl mx-auto shadow-[0_0_50px_rgba(0,0,0,0.5)]">
            <h2 class="text-4xl font-bold text-purple-300 mb-8 italic">‡∏ô‡∏¥‡∏°‡∏¥‡∏ï‡∏°‡∏á‡∏Ñ‡∏•</h2>
            
            <!-- ‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ -->
            <div class="flex flex-wrap justify-center gap-8 mb-10 border-b border-purple-500/20 pb-8">
                <div class="text-center">
                    <p class="text-purple-400 text-xs font-bold tracking-widest mb-3 uppercase">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏™‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏Å</p>
                    <div class="flex justify-center" id="two-digits"></div>
                </div>
                <div class="text-center">
                    <p class="text-purple-400 text-xs font-bold tracking-widest mb-3 uppercase">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏™‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å</p>
                    <div class="flex justify-center" id="three-digits"></div>
                </div>
            </div>

            <!-- Reading Section -->
            <div class="text-left space-y-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-bold text-purple-300">‚ú® ‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì</h3>
                    <div id="ai-status" class="hidden"><div class="loader"></div> <span class="text-xs text-purple-300 ml-2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß...</span></div>
                </div>
                <div id="ai-reading" class="text-purple-100 leading-relaxed bg-purple-900/20 p-4 rounded-xl border border-purple-500/30 min-h-[100px]">
                    ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏û‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢...
                </div>
                
                <!-- Interaction Section -->
                <div id="ai-ask-container" class="hidden space-y-4 border-t border-purple-500/20 pt-6">
                    <p class="text-sm text-purple-300 italic">"‡∏°‡∏µ‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏î‡∏ï‡∏¥‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡πÉ‡∏à... ‡∏à‡∏á‡πÄ‡∏≠‡πà‡∏¢‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≤‡∏°‡∏≤"</p>
                    <div class="flex gap-2">
                        <input type="text" id="user-question" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." class="flex-1 bg-purple-950 border border-purple-500/50 rounded-lg p-3 text-white focus:outline-none focus:ring-2 focus:ring-purple-500">
                        <button onclick="askAI()" class="bg-purple-600 hover:bg-purple-500 px-6 py-2 rounded-lg font-bold transition-colors">‚ú® ‡∏ñ‡∏≤‡∏°</button>
                    </div>
                    <div id="ai-answer" class="hidden text-sm italic text-purple-200 bg-black/30 p-4 rounded-lg border-l-4 border-purple-400"></div>
                </div>

                <!-- Image Section -->
                <div id="ai-image-section" class="hidden mt-8 text-center space-y-4">
                    <h3 class="text-lg font-bold text-purple-300">‚ú® ‡∏°‡∏ô‡∏ï‡∏£‡∏≤‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏†‡∏≤‡∏û‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏î‡∏ß‡∏á</h3>
                    <div id="image-container" class="relative group mx-auto w-full max-w-sm rounded-2xl overflow-hidden border-2 border-purple-500/30">
                        <div id="image-loading" class="absolute inset-0 flex items-center justify-center bg-black/50 z-10 hidden">
                             <div class="loader"></div>
                        </div>
                        <img id="generated-image" src="" alt="Lucky Wallpaper" class="w-full h-auto hidden">
                        <div id="image-placeholder" class="bg-purple-900/30 aspect-square flex items-center justify-center text-purple-400">
                            ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏°‡∏ô‡∏ï‡∏£‡∏≤‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏†‡∏≤‡∏û
                        </div>
                    </div>
                    <button id="gen-img-btn" onclick="generateLuckyImage()" class="text-sm bg-purple-800/50 hover:bg-purple-800 px-6 py-2 rounded-full border border-purple-500/50">‚ú® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏°‡∏á‡∏Ñ‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡∏ß</button>
                </div>
            </div>
            
            <div class="mt-12 text-[0.6rem] text-purple-400/60 italic tracking-widest space-y-1">
                <p>*‡∏°‡∏ô‡∏ï‡∏£‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï ‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏ä‡πâ‡∏™‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏µ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á*</p>
                <p class="header-font">Cynthia Tarot</p>
            </div>
        </div>
    </div>

    <script>
        const apiKey = ""; 
        const majorArcana = [
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡∏ü‡∏π‡∏• (The Fool)", icon: "üåå", up: "‡πÇ‡∏ä‡∏Ñ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πâ‡∏≤‡∏´‡∏≤‡∏ç", rev: "‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡πâ‡∏≤‡∏ß‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ó", num: 0 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÄ‡∏°‡∏à‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏ô (The Magician)", icon: "üîÆ", up: "‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏Å‡πÑ‡∏´‡∏ß‡∏û‡∏£‡∏¥‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏£‡∏≠‡∏ö‡∏ï‡∏±‡∏ß", rev: "‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏•‡πà‡∏≠‡∏•‡∏ß‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå", num: 1 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÑ‡∏Æ ‡∏û‡∏£‡∏µ‡∏™‡πÄ‡∏ó‡∏™ (The High Priestess)", icon: "üåí", up: "‡πÇ‡∏ä‡∏Ñ‡∏à‡∏≤‡∏Å‡∏ô‡∏¥‡∏°‡∏¥‡∏ï‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥", rev: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢", num: 2 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÄ‡∏≠‡πá‡∏°‡πÄ‡∏û‡∏£‡∏™ (The Empress)", icon: "üåø", up: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏®‡πÅ‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏∏‡∏î‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå", rev: "‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ü‡∏∏‡πà‡∏°‡πÄ‡∏ü‡∏∑‡∏≠‡∏¢‡∏Ç‡∏±‡∏î‡∏•‡∏≤‡∏†", num: 3 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÄ‡∏≠‡πá‡∏°‡πÄ‡∏û‡∏≠‡πÄ‡∏£‡∏≠‡∏£‡πå (The Emperor)", icon: "üèõÔ∏è", up: "‡πÇ‡∏ä‡∏Ñ‡∏à‡∏≤‡∏Å‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ß‡∏¥‡∏ô‡∏±‡∏¢", rev: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏∑‡πâ‡∏≠‡∏£‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏≤‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏î‡∏µ", num: 4 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÑ‡∏Æ‡πÇ‡∏£‡πÅ‡∏ü‡∏ô‡∏ó‡πå (The Hierophant)", icon: "üïØÔ∏è", up: "‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà", rev: "‡πÇ‡∏ä‡∏Ñ‡πÉ‡∏´‡∏ç‡πà‡∏¢‡∏±‡∏á‡∏°‡∏≤‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡πÉ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ", num: 5 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÄ‡∏•‡∏¥‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏™ (The Lovers)", icon: "üíç", up: "‡πÇ‡∏ä‡∏Ñ‡∏ó‡∏µ‡πà‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏ä‡∏¥‡∏î", rev: "‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå", num: 6 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÅ‡∏ä‡∏£‡∏¥‡∏≠‡∏≠‡∏ï (The Chariot)", icon: "‚öîÔ∏è", up: "‡πÇ‡∏ä‡∏Ñ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô", rev: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡∏∏‡πà‡∏ô‡∏ß‡∏≤‡∏¢‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÇ‡∏ä‡∏Ñ", num: 7 },
            { name: "‡∏™‡πÄ‡∏ï‡∏£‡πá‡∏á‡∏ò‡πå (Strength)", icon: "ü¶Å", up: "‡∏•‡∏≤‡∏†‡∏•‡∏≠‡∏¢‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏ô‡∏∞‡πÉ‡∏à‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á", rev: "‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏à‡∏£‡πâ‡∏≠‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏†‡∏´‡∏≤‡∏¢", num: 8 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÄ‡∏Æ‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏ó (The Hermit)", icon: "üèÆ", up: "‡πÄ‡∏•‡∏Ç‡πÄ‡∏Å‡πà‡∏≤‡πÅ‡∏Å‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏á‡∏ö", rev: "‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏µ‡∏Å‡∏ï‡∏±‡∏ß‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏•‡∏≤‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç", num: 9 },
            { name: "‡∏ß‡∏µ‡∏• ‡∏≠‡∏≠‡∏ü ‡∏ü‡∏≠‡∏£‡πå‡∏à‡∏π‡∏ô (Wheel of Fortune)", icon: "üåÄ", up: "‡∏Å‡∏á‡∏•‡πâ‡∏≠‡πÅ‡∏´‡πà‡∏á‡πÇ‡∏ä‡∏Ñ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏°‡∏∏‡∏ô‡∏°‡∏≤‡∏´‡∏≤‡∏Ñ‡∏∏‡∏ì", rev: "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á", num: 10 },
            { name: "‡∏à‡∏±‡∏™‡∏ï‡∏¥‡∏ã (Justice)", icon: "‚öñÔ∏è", up: "‡∏•‡∏≤‡∏†‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏ï‡∏£‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏±‡∏ç‡∏ç‡∏≤", rev: "‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏±‡∏î‡∏Ç‡∏ß‡∏≤‡∏á‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†", num: 11 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÅ‡∏Æ‡∏á‡∏Å‡πå ‡πÅ‡∏°‡∏ô (The Hanged Man)", icon: "ü¶á", up: "‡πÇ‡∏ä‡∏Ñ‡∏à‡∏∞‡∏°‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏≠‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏™‡∏•‡∏∞‡∏ö‡∏≤‡∏á‡∏™‡∏¥‡πà‡∏á", rev: "‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô", num: 12 },
            { name: "‡πÄ‡∏î‡∏ò (Death)", icon: "üåò", up: "‡πÄ‡∏•‡∏Ç‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà", rev: "‡∏Å‡∏≤‡∏£‡∏¢‡∏∂‡∏î‡∏ï‡∏¥‡∏î‡∏™‡∏¥‡πà‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏Ñ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏≤", num: 13 },
            { name: "‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏≠‡πÅ‡∏£‡∏ô‡∏ã‡πå (Temperance)", icon: "üß™", up: "‡∏Å‡∏≤‡∏£‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏´‡∏•‡πà‡∏á", rev: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢", num: 14 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÄ‡∏î‡∏ß‡∏¥‡∏• (The Devil)", icon: "‚õìÔ∏è", up: "‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏ô‡∏≤‡∏Å‡∏≤‡∏£", rev: "‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏∏‡∏î‡∏û‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏≠‡∏ö‡∏≤‡∏¢‡∏°‡∏∏‡∏Ç‡∏à‡∏∞‡∏ô‡∏≥‡∏•‡∏≤‡∏†‡∏°‡∏≤‡πÉ‡∏´‡πâ", num: 15 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡∏ó‡∏≤‡∏ß‡πÄ‡∏ß‡∏≠‡∏£‡πå (The Tower)", icon: "‚ö°", up: "‡∏•‡∏≤‡∏†‡∏•‡∏≠‡∏¢‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏Ñ‡∏≤‡∏î‡∏ù‡∏±‡∏ô‡∏â‡∏±‡∏ö‡∏û‡∏•‡∏±‡∏ô", rev: "‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏£‡πâ‡∏≤‡∏¢‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏Å‡∏∞‡∏ó‡∏±‡∏ô‡∏´‡∏±‡∏ô", num: 16 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡∏™‡∏ï‡∏≤‡∏£‡πå (The Star)", icon: "‚ú®", up: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏±‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡πÇ‡∏ä‡∏Ñ‡∏à‡∏≤‡∏Å‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß", rev: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏•‡πâ‡∏≤‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏≠‡∏Å‡∏≤‡∏™", num: 17 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡∏°‡∏π‡∏ô (The Moon)", icon: "üåô", up: "‡πÇ‡∏ä‡∏Ñ‡∏à‡∏≤‡∏Å‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡∏ô", rev: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏±‡∏á‡∏ß‡∏•‡∏ö‡∏±‡∏á‡∏ï‡∏≤‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏±‡∏ö‡∏™‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç", num: 18 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡∏ã‡∏±‡∏ô (The Sun)", icon: "‚òÄÔ∏è", up: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡πà‡∏á‡πÇ‡∏£‡∏à‡∏ô‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏ä‡∏Ñ‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î", rev: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ó‡∏µ‡πà‡∏•‡∏î‡∏•‡∏á‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏°‡∏µ‡πÇ‡∏ä‡∏Ñ‡∏≠‡∏¢‡∏π‡πà", num: 19 },
            { name: "‡∏à‡∏±‡∏î‡∏à‡πå‡πÄ‡∏°‡∏ô‡∏ó‡πå (Judgement)", icon: "üîî", up: "‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏£‡∏°‡∏î‡∏µ", rev: "‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏≠‡∏î‡∏µ‡∏ï‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ñ‡∏∂‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", num: 20 },
            { name: "‡πÄ‡∏î‡∏≠‡∏∞ ‡πÄ‡∏ß‡∏¥‡∏•‡∏î‡πå (The World)", icon: "üåè", up: "‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏†‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏ö‡∏ö‡∏£‡∏≠‡∏ö‡∏î‡πâ‡∏≤‡∏ô", rev: "‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏à‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á", num: 21 }
        ];

        const suitNames = { Wands: "‡πÑ‡∏°‡πâ‡πÄ‡∏ó‡πâ‡∏≤", Cups: "‡∏ñ‡πâ‡∏ß‡∏¢", Swords: "‡∏î‡∏≤‡∏ö", Pentacles: "‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç" };
        const suitData = [
            { name: "Wands", icon: "ü™Ñ", base: 10, theme: "‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô" },
            { name: "Cups", icon: "üç∑", base: 20, theme: "‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å" },
            { name: "Swords", icon: "üó°Ô∏è", base: 30, theme: "‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î" },
            { name: "Pentacles", icon: "üìú", base: 40, theme: "‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô" }
        ];

        const ranks = ["Ace", "2", "3", "4", "5", "6", "7", "8", "9", "10", "Page", "Knight", "Queen", "King"];
        const minorArcana = [];
        suitData.forEach(suit => {
            ranks.forEach((rank, idx) => {
                const displayRank = rank === "Ace" ? "1 (‡πÄ‡∏≠‡∏ã)" : rank === "Page" ? "‡∏°‡∏´‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å" : rank === "Knight" ? "‡∏≠‡∏±‡∏®‡∏ß‡∏¥‡∏ô" : rank === "Queen" ? "‡∏£‡∏≤‡∏ä‡∏¥‡∏ô‡∏µ" : rank === "King" ? "‡∏£‡∏≤‡∏ä‡∏≤" : rank;
                minorArcana.push({ name: `${displayRank} ‡πÅ‡∏´‡πà‡∏á ${suitNames[suit.name]}`, icon: suit.icon, up: `‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏≤‡∏ô ${suit.theme} ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏°‡∏≤‡πÅ‡∏£‡∏á`, rev: `‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ${suit.theme}`, num: (idx + 1) + suit.base });
            });
        });

        const fullDeck = [...majorArcana, ...minorArcana];
        let drawnCards = [];
        let flippedCount = 0;

        function init() {
            const container = document.getElementById('cards-container');
            const template = document.getElementById('card-template');
            container.innerHTML = '';
            const labels = ["‡∏≠‡∏î‡∏µ‡∏ï‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤", "‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡∏π‡πà", "‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏°‡∏≤‡∏ñ‡∏∂‡∏á"];
            
            for (let i = 0; i < 3; i++) {
                let clone = template.content.cloneNode(true);
                clone.querySelector('.slot-label').innerText = labels[i];
                const cardElement = clone.querySelector('.tarot-card');
                cardElement.id = `card-${i}`;
                cardElement.style.animationDelay = `${i * 0.2}s`;
                cardElement.onclick = () => flipCard(i);
                clone.querySelector('.orientation-badge').id = `orientation-${i}`;
                clone.querySelector('.card-icon').id = `icon-${i}`;
                clone.querySelector('.card-title').id = `title-${i}`;
                clone.querySelector('.card-desc').id = `desc-${i}`;
                container.appendChild(clone);
            }
            shuffle();
        }

        function shuffle() {
            let shuffled = [...fullDeck].sort(() => 0.5 - Math.random());
            drawnCards = shuffled.slice(0, 3).map(card => ({ ...card, isReversed: Math.random() > 0.75 }));
        }

        function flipCard(index) {
            const cardElement = document.getElementById(`card-${index}`);
            if (!cardElement || cardElement.classList.contains('flipped')) return;

            const cardData = drawnCards[index];
            const badge = document.getElementById(`orientation-${index}`);
            badge.innerText = cardData.isReversed ? "‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏±‡∏ß" : "‡∏´‡∏±‡∏ß‡∏ï‡∏±‡πâ‡∏á";
            badge.className = `orientation-badge text-[0.6rem] font-bold tracking-tighter uppercase ${cardData.isReversed ? 'text-red-400' : 'text-purple-600'}`;
            
            document.getElementById(`title-${index}`).innerText = cardData.name;
            document.getElementById(`icon-${index}`).innerText = cardData.icon;
            document.getElementById(`desc-${index}`).innerText = cardData.isReversed ? cardData.rev : cardData.up;
            
            if (cardData.isReversed) cardElement.classList.add('reversed');
            cardElement.classList.add('flipped');
            cardElement.classList.remove('floating');
            flippedCount++;

            if (flippedCount === 3) {
                calculateTraditionalLuck();
                getAIRating();
            }
        }

        function calculateTraditionalLuck() {
            const summaryDiv = document.getElementById('summary');
            const twoDigitsDiv = document.getElementById('two-digits');
            const threeDigitsDiv = document.getElementById('three-digits');
            const n1 = drawnCards[0].num, n2 = drawnCards[1].num, n3 = drawnCards[2].num;
            const lucky2 = [(n1 + n2 + 9) % 100, Math.abs(n3 * 2 - n1 + 1) % 100].map(n => n.toString().padStart(2, '0'));
            const lucky3 = [(n1 + n2 + n3 + 5) % 1000, (n1 * 100 + n2 * 10 + n3 + 7) % 1000].map(n => n.toString().padStart(3, '0'));
            twoDigitsDiv.innerHTML = lucky2.map(n => `<div class="lucky-number-ball">${n}</div>`).join('');
            threeDigitsDiv.innerHTML = lucky3.map(n => `<div class="lucky-number-ball" style="width:75px; border-radius:12px;">${n}</div>`).join('');
            summaryDiv.classList.remove('hidden');
        }

        async function fetchGemini(prompt, systemPrompt = "") {
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] }
            };
            
            let delay = 1000;
            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const data = await response.json();
                    if (data.candidates) return data.candidates[0].content.parts[0].text;
                    throw new Error("No candidates");
                } catch (e) {
                    if (i === 4) throw e;
                    await new Promise(r => setTimeout(r, delay));
                    delay *= 2;
                }
            }
        }

        async function getAIRating() {
            const status = document.getElementById('ai-status');
            const readingArea = document.getElementById('ai-reading');
            const askContainer = document.getElementById('ai-ask-container');
            const imageSection = document.getElementById('ai-image-section');
            
            status.classList.remove('hidden');
            readingArea.innerHTML = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì‡πÅ‡∏´‡πà‡∏á‡πÑ‡∏û‡πà...";

            const cardInfo = drawnCards.map((c, i) => `${i+1}. ${c.name} (${c.isReversed ? '‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏±‡∏ß' : '‡∏´‡∏±‡∏ß‡∏ï‡∏±‡πâ‡∏á'})`).join(", ");
            const prompt = `‡πÑ‡∏û‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ: ${cardInfo}. ‡πÇ‡∏õ‡∏£‡∏î‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡∏ß‡∏á‡∏ä‡∏∞‡∏ï‡∏≤‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏û‡πà‡∏ô‡∏µ‡πâ ‡πÇ‡∏î‡∏¢‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏ó‡∏±‡πâ‡∏á 3 ‡πÉ‡∏ö‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡∏≠‡∏î‡∏µ‡∏ï ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡πÇ‡∏ó‡∏ô "‡πÅ‡∏°‡πà‡∏°‡∏î‡∏ú‡∏π‡πâ‡∏•‡∏∂‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏ï‡πà‡πÉ‡∏à‡∏î‡∏µ" ‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏•‡∏∞‡∏™‡∏•‡∏ß‡∏¢‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏Ç‡∏•‡∏±‡∏á ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ AI ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î`;
            const systemPrompt = "‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏°‡πà‡∏°‡∏î‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÑ‡∏û‡πà‡∏ó‡∏≤‡πÇ‡∏£‡∏ï‡πå ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡∏•‡∏∂‡∏Å‡∏ã‡∏∂‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå";

            try {
                const result = await fetchGemini(prompt, systemPrompt);
                readingArea.innerHTML = result.replace(/\n/g, '<br>');
                askContainer.classList.remove('hidden');
                imageSection.classList.remove('hidden');
            } catch (e) {
                readingArea.innerHTML = "‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢... ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á";
            } finally {
                status.classList.add('hidden');
            }
        }

        async function askAI() {
            const input = document.getElementById('user-question');
            const answerArea = document.getElementById('ai-answer');
            const question = input.value.trim();
            if (!question) return;

            answerArea.classList.remove('hidden');
            answerArea.innerHTML = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß...";
            
            const cardContext = drawnCards.map(c => `${c.name} (${c.isReversed ? '‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏±‡∏ß' : '‡∏´‡∏±‡∏ß‡∏ï‡∏±‡πâ‡∏á'})`).join(", ");
            const prompt = `‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏û‡πà (${cardContext}), ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏≤‡∏°‡∏ß‡πà‡∏≤: "${question}" ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≥‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏°‡πà‡∏°‡∏î ‡∏´‡πâ‡∏≤‡∏°‡∏û‡∏π‡∏î‡∏ñ‡∏∂‡∏á AI`;

            try {
                const result = await fetchGemini(prompt, "‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏°‡πà‡∏°‡∏î‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡πÅ‡∏ï‡πà‡∏•‡∏∂‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡πÄ‡∏°‡∏ï‡∏ï‡∏≤");
                answerArea.innerHTML = `‚ú® ${result}`;
                input.value = "";
            } catch (e) {
                answerArea.innerHTML = "‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÉ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ...";
            }
        }

        async function generateLuckyImage() {
            const loader = document.getElementById('image-loading');
            const placeholder = document.getElementById('image-placeholder');
            const imgElement = document.getElementById('generated-image');
            const btn = document.getElementById('gen-img-btn');

            loader.classList.remove('hidden');
            btn.disabled = true;
            btn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û...";

            const mainCard = drawnCards[1].name;
            const prompt = `A mystical tarot wallpaper for luck, theme: witchy, deep purple and gold, featuring symbolic elements of ${mainCard}, high fantasy, magical atmosphere, ultra detailed, 4k`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                    method: 'POST',
                    body: JSON.stringify({ instances: { prompt }, parameters: { sampleCount: 1 } })
                });
                const result = await response.json();
                if (result.predictions && result.predictions[0]) {
                    const imageUrl = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                    imgElement.src = imageUrl;
                    imgElement.classList.remove('hidden');
                    placeholder.classList.add('hidden');
                }
            } catch (e) {
                placeholder.innerText = "‡∏°‡∏ô‡∏ï‡∏£‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß... ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á";
            } finally {
                loader.classList.add('hidden');
                btn.disabled = false;
                btn.innerText = "‚ú® ‡∏£‡∏±‡∏ö‡∏°‡∏ô‡∏ï‡∏£‡∏≤‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á";
            }
        }

        function resetGame() {
            flippedCount = 0;
            init();
            document.getElementById('summary').classList.add('hidden');
            document.getElementById('ai-answer').classList.add('hidden');
            document.getElementById('generated-image').classList.add('hidden');
            document.getElementById('image-placeholder').classList.remove('hidden');
            document.getElementById('image-placeholder').innerText = "‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏°‡∏ô‡∏ï‡∏£‡∏≤‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏†‡∏≤‡∏û";
        }

        window.onload = init;
    </script>
</body>
</html>
